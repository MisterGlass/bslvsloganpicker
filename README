This code is terrible. Don't judge
